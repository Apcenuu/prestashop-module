language: php

sudo: false

php:
  - 5.6

env:
  global:
    - DB_USER=root
    - DB_HOST=localhost
    - DB_NAME=test_prestashop

before_script:
  - bash tests/bin/clone_prestashop.sh
  - cd ../PrestaShop
  - cp tests/parameters.yml.travis app/config/parameters.yml
  - bash travis-scripts/install-prestashop

script:
  - cd $TRAVIS_BUILD_DIR
  - bash tests/bin/script.sh
  - php ../PrestaShop/vendor/bin/phpunit -c phpunit.xml.dist

deploy:
  skip_cleanup: true
  provider: script
  script: make
  on:
    php: 5.6
    branch: master
    condition: "$DEPLOY = true"
